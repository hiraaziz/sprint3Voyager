"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Hirapipelinestack = void 0;
const aws_cdk_lib_1 = require("aws-cdk-lib");
const cdk = require("aws-cdk-lib");
const aws_codepipeline_actions_1 = require("aws-cdk-lib/aws-codepipeline-actions");
const hirastagestack_1 = require("./hirastagestack");
// const {Hirastagestack}=require('./hirastagestack')
const app = new cdk.App();
class Hirapipelinestack extends aws_cdk_lib_1.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        const pipeline = new aws_cdk_lib_1.pipelines.CodePipeline(this, 'Pipeline', {
            synth: new aws_cdk_lib_1.pipelines.ShellStep('Synth', {
                //^ Using Secrets Manager to provide the access token to authenticate to GitHub
                input: aws_cdk_lib_1.pipelines.CodePipelineSource.gitHub('hiraaziz2022skipq/sprint3Voyager', "main", {
                    authentication: cdk.SecretValue.secretsManager('webtken'),
                    trigger: aws_codepipeline_actions_1.GitHubTrigger.POLL,
                }),
                commands: [
                    "cd hira4sprint", "npm ci", "npx cdk synth"
                ],
                primaryOutputDirectory: "hira4sprint/cdk.out"
            })
        });
        const stagebeta = new hirastagestack_1.Hirastagestack(this, "betastage");
        pipeline.addStage(stagebeta);
        const prod = new hirastagestack_1.Hirastagestack(this, "prod");
        pipeline.addStage(prod);
    }
}
exports.Hirapipelinestack = Hirapipelinestack;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGlyYXBpcGVsaW5lc3RhY2suanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJoaXJhcGlwZWxpbmVzdGFjay50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSw2Q0FBbUY7QUFJbkYsbUNBQW1DO0FBQ25DLG1GQUFxRTtBQUNyRSxxREFBK0M7QUFDL0MscURBQXFEO0FBQ3JELE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDO0FBRTFCLE1BQWEsaUJBQWtCLFNBQVEsbUJBQUs7SUFDeEMsWUFBWSxLQUFnQixFQUFFLEVBQVUsRUFBRSxLQUFrQjtRQUMxRCxLQUFLLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUV4QixNQUFNLFFBQVEsR0FBRyxJQUFJLHVCQUFTLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRSxVQUFVLEVBQUU7WUFDNUQsS0FBSyxFQUFFLElBQUksdUJBQVMsQ0FBQyxTQUFTLENBQUMsT0FBTyxFQUFFO2dCQUMxQywrRUFBK0U7Z0JBQzNFLEtBQUssRUFBRSx1QkFBUyxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxrQ0FBa0MsRUFBRSxNQUFNLEVBQUM7b0JBQ3BGLGNBQWMsRUFBQyxHQUFHLENBQUMsV0FBVyxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUM7b0JBQ3hELE9BQU8sRUFBQyx3Q0FBYSxDQUFDLElBQUk7aUJBQUUsQ0FBQztnQkFDOUIsUUFBUSxFQUFFO29CQUNULGdCQUFnQixFQUFDLFFBQVEsRUFBQyxlQUFlO2lCQUMxQztnQkFDSCxzQkFBc0IsRUFBRyxxQkFBcUI7YUFDN0MsQ0FBQztTQUNELENBQUMsQ0FBQztRQU1MLE1BQU0sU0FBUyxHQUFHLElBQUksK0JBQWMsQ0FBQyxJQUFJLEVBQUMsV0FBVyxDQUFDLENBQUE7UUFDdEQsUUFBUSxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsQ0FBQTtRQUU1QixNQUFNLElBQUksR0FBQyxJQUFJLCtCQUFjLENBQUMsSUFBSSxFQUFDLE1BQU0sQ0FBQyxDQUFBO1FBQzFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDekIsQ0FBQztDQW1CQTtBQTdDTCw4Q0E2Q0siLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEdXJhdGlvbiwgcGlwZWxpbmVzLCBSZW1vdmFsUG9saWN5LCBTdGFjaywgU3RhY2tQcm9wc30gZnJvbSAnYXdzLWNkay1saWInO1xyXG5pbXBvcnQgKiBhcyBsYW1iZGEgZnJvbSAnYXdzLWNkay1saWIvYXdzLWxhbWJkYSc7XHJcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xyXG5pbXBvcnQgeyBNYW5hZ2VkUG9saWN5LCBSb2xlLCBTZXJ2aWNlUHJpbmNpcGFsIH0gZnJvbSAnYXdzLWNkay1saWIvYXdzLWlhbSc7XHJcbmltcG9ydCAqIGFzIGNkayBmcm9tICdhd3MtY2RrLWxpYic7XHJcbmltcG9ydCB7IEdpdEh1YlRyaWdnZXIgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtY29kZXBpcGVsaW5lLWFjdGlvbnMnO1xyXG5pbXBvcnQge0hpcmFzdGFnZXN0YWNrfSBmcm9tICcuL2hpcmFzdGFnZXN0YWNrJ1xyXG4vLyBjb25zdCB7SGlyYXN0YWdlc3RhY2t9PXJlcXVpcmUoJy4vaGlyYXN0YWdlc3RhY2snKVxyXG5jb25zdCBhcHAgPSBuZXcgY2RrLkFwcCgpO1xyXG5cclxuZXhwb3J0IGNsYXNzIEhpcmFwaXBlbGluZXN0YWNrIGV4dGVuZHMgU3RhY2sge1xyXG4gICAgY29uc3RydWN0b3Ioc2NvcGU6IENvbnN0cnVjdCwgaWQ6IHN0cmluZywgcHJvcHM/OiBTdGFja1Byb3BzKSB7XHJcbiAgICAgIHN1cGVyKHNjb3BlLCBpZCwgcHJvcHMpO1xyXG5cclxuICAgICAgY29uc3QgcGlwZWxpbmUgPSBuZXcgcGlwZWxpbmVzLkNvZGVQaXBlbGluZSh0aGlzLCAnUGlwZWxpbmUnLCB7XHJcbiAgICAgICAgc3ludGg6IG5ldyBwaXBlbGluZXMuU2hlbGxTdGVwKCdTeW50aCcsIHtcclxuICAgICAgLy9eIFVzaW5nIFNlY3JldHMgTWFuYWdlciB0byBwcm92aWRlIHRoZSBhY2Nlc3MgdG9rZW4gdG8gYXV0aGVudGljYXRlIHRvIEdpdEh1YlxyXG4gICAgICAgICAgaW5wdXQ6IHBpcGVsaW5lcy5Db2RlUGlwZWxpbmVTb3VyY2UuZ2l0SHViKCdoaXJhYXppejIwMjJza2lwcS9zcHJpbnQzVm95YWdlcicsIFwibWFpblwiLHtcclxuICAgICAgICAgICAgYXV0aGVudGljYXRpb246Y2RrLlNlY3JldFZhbHVlLnNlY3JldHNNYW5hZ2VyKCd3ZWJ0a2VuJyksXHJcbiAgICAgICAgICAgIHRyaWdnZXI6R2l0SHViVHJpZ2dlci5QT0xMLH0pLFxyXG4gICAgICAgICAgIGNvbW1hbmRzOiBbXHJcbiAgICAgICAgICAgIFwiY2QgaGlyYTRzcHJpbnRcIixcIm5wbSBjaVwiLFwibnB4IGNkayBzeW50aFwiXHJcbiAgICAgICAgICBdLFxyXG4gICAgICAgIHByaW1hcnlPdXRwdXREaXJlY3RvcnkgOiBcImhpcmE0c3ByaW50L2Nkay5vdXRcIlxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICBcclxuICAgICAgY29uc3Qgc3RhZ2ViZXRhID0gbmV3IEhpcmFzdGFnZXN0YWNrKHRoaXMsXCJiZXRhc3RhZ2VcIilcclxuICAgICAgcGlwZWxpbmUuYWRkU3RhZ2Uoc3RhZ2ViZXRhKVxyXG5cclxuICAgICAgY29uc3QgcHJvZD1uZXcgSGlyYXN0YWdlc3RhY2sodGhpcyxcInByb2RcIilcclxuICAgICAgcGlwZWxpbmUuYWRkU3RhZ2UocHJvZClcclxuICAgIH1cclxuICBcclxuXHJcblxyXG4gICAgLy8gY3JlYXRlX3JvbGUoKTphbnl7XHJcbiAgICAvLyAgICAgY29uc3Qgcm9sZSA9IG5ldyBSb2xlKHRoaXMsICdleGFtcGxlLWlhbS1yb2xlJywge1xyXG4gICAgLy8gICAgICAgYXNzdW1lZEJ5OiBuZXcgU2VydmljZVByaW5jaXBhbCgnbGFtYmRhLmFtYXpvbmF3cy5jb20nKSxcclxuICAgIC8vICAgICAgIGRlc2NyaXB0aW9uOiAnQW4gZXhhbXBsZSBJQU0gcm9sZSBpbiBBV1MgQ0RLJyxcclxuICAgIC8vICAgICAgIG1hbmFnZWRQb2xpY2llczogW1xyXG4gICAgLy8gICAgICAgICBNYW5hZ2VkUG9saWN5LmZyb21Bd3NNYW5hZ2VkUG9saWN5TmFtZSgnQ2xvdWRXYXRjaEZ1bGxBY2Nlc3MnKSxcclxuICAgIC8vICAgICAgICAgTWFuYWdlZFBvbGljeS5mcm9tQXdzTWFuYWdlZFBvbGljeU5hbWUoJ0FtYXpvbkR5bmFtb0RCRnVsbEFjY2VzcycpLFxyXG4gICAgLy8gICAgICAgICBNYW5hZ2VkUG9saWN5LmZyb21Bd3NNYW5hZ2VkUG9saWN5TmFtZSgnc2VydmljZS1yb2xlL0FXU0xhbWJkYUJhc2ljRXhlY3V0aW9uUm9sZScpLFxyXG4gICAgLy8gICAgICAgICBNYW5hZ2VkUG9saWN5LmZyb21Bd3NNYW5hZ2VkUG9saWN5TmFtZShcIkFXU0NvZGVQaXBlbGluZV9GdWxsQWNjZXNzXCIpLFxyXG4gICAgLy8gICAgICAgICBNYW5hZ2VkUG9saWN5LmZyb21Bd3NNYW5hZ2VkUG9saWN5TmFtZShcIkFtYXpvblMzRnVsbEFjY2Vzc1wiKSxcclxuICAgIC8vICAgICAgICAgTWFuYWdlZFBvbGljeS5mcm9tQXdzTWFuYWdlZFBvbGljeU5hbWUoXCJBd3NDbG91ZEZvcm1hdGlvbkZ1bGxBY2Nlc3NcIiksXHJcbiAgICAvLyAgICAgICBdLFxyXG4gICAgLy8gICAgIH0pO1xyXG4gICAgLy8gICAgIHJldHVybiByb2xlXHJcbiAgICAvLyAgIH1cclxuICAgIH1cclxuIl19